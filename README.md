## Overview

- Creates a Wordpress site running on EC2 instances with images served via a cloudfront distribution from an S3 bucket
- Terraform creates and manages the AWS infrastructure, with Ansible providing provisioning.
- HTTPS is setup using AWS Certificate Managers which validates and manages certificates on the Elastic Load Balancer, which uses the SNI protocol
- An existing wordpress site using mysql is migrated to AWS, where an RDS database is used. Terraform RDS S3 Import process is automated whereby web server and DB content is backed up to an S3, which
- Autoscaling group with Cloudwatch metrics based on CPU Utilization are created.
- terraform user_data & template are used for provisioning
- ansible-pull is used to pull an ansible playbook from github that then retrieves and executes a set of ansible roles from an s3 bucket
- ansible roles are: wordpress
- an IAM policy is setup for s3 access via ansible (boto3) and for RDS to access backup S3 buckets
- Bastion setup for SSH access
- terraform state stored on s3 bucket
- Bastion and Load Balancer on public subnet, Web on private subnet
- NAT gateway setup for outbound from private subnet


### Installing

1. Install Terraform with appropriate system package. Update PATH

2. Setup credentials here ~/.aws/credentials
```
[profile_name]
aws_access_key_id = ""
aws_secret_access_key = ""
region = us-east-2
```

3. Change variables in io.tf file for aws profile, credentials file, s3 bucket, and for ones own domain name:
```
./var_tf.sh -v "variable_name1=foo variable_name2=bar"
```
```
./var_tf.sh -v "ec2profile=foo cred_file=bar s3_bucket_name=baz www_domain_name=yourname.com"
```

4. Zip each ansible role folder separately from Ansible_Roles repo and upload to own bucket (bucket name added to variables above)

5. Run Terraform
```
terraform init
terraform plan
terraform apply
```

6. ssh into Bastion using private key key_ec2.pem, which is generated by terraform
```
ssh -i key_ec2.pem ubuntu@bastion_ip
```
#### License

This project is licensed under the MIT License - see the [LICENSE.md](LICENSE.md) file for details
